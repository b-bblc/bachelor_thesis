УДК 004.855.5  
А.В.Парасич  
аспирант кафедры «Электронные вычислительные машины», факультет «Компьютерные
технологии, управление и радиоэлектроника», Южно-Уральский государственный
университет  
г. Челябинск, Российская Федерация;  
И.В.Парасич  
к.т.н. доцент кафедры «Инфокоммуникационные технологии», факультет
«Компьютерные технологии, управление и радиоэлектроника», Южно-Уральский
государственный университет  
г. Челябинск, Российская Федерация;  
ИСПОЛЬЗОВАНИЕ АПРИОРНЫХ ЗНАНИЙ В ЗАДАЧЕ ПОИСКА ОБЪЕКТОВ НА ИЗОБРАЖЕНИИ.
DEFORMABLE PART MODELS.  
Аннотация  
Использование априорных знаний является важной частью разработки систем
распознавания образов. Зачастую именно правильное использование априорных
знаний позволяет довести качество алгоритма распознавания до уровня
практической применимости. В статье подробно рассматривается один из известных
способов представления знаний - Deformable Part Models. Приводится детальный
анализ преимуществ и недостатков данного подхода и границ его применимости.  
Ключевые слова.  
Распознавание образов, машинное обучение, поиск объектов на изображении,
Deformable Part Models,  
представление знаний.  
Принципиальное противоречие, с которым приходится сталкиваться разработчикам
систем распознавания образов на основе машинного обучения, состоит в
следующем: пользователю обычно нужна система с минимальным риском ошибки и
надёжностью, близкой к 100%, однако алгоритмы распознавания и обучения обычно
ненадёжны и подвержены ошибкам. Используя классические техники машинного
обучения и распознавания образов, очень трудно получить качество, близкое к
100%.  
Для разрешения данного противоречия разработчики систем распознавания образов
часто прибегают к использованию априорных знаний о задаче. Фактически, в любой
реальной системе распознавания в том  
или ином виде используются априорные знания о распознаваемых объектах.
Например, в системах распознавания текстов используются словари допустимых
слов языка, структурные модели символов, синтаксические модели предложений.
Использование подобных знаний позволяет существенно поднять качество работы
систем распознавания.  
Как правильно использовать имеющиеся априорные знания - открытый вопрос.
Рассмотрим некоторые подходы к использованию знаний на примере задачи поиска
объектов на изображении, проанализируем сильные и слабые стороны данных
подходов. Можно вообще никак не использовать априорные знания, а использовать
машинное обучение в чистом виде - собрать обучающую выборку положительных и
отрицательных примеров, обучить по ней детектор объекта и выдавать его ответ
как результат работы алгоритма. В таком случае нам может потребоваться очень
большая обучающая выборка, нетривиальные усилия по настройке алгоритма
обучения, и всё равно на выходе нет гарантии внутренней непротиворечивости
выдаваемого пользователю результата. Посмотрим, как можно упростить задачу с
использованием априорных знаний о структуре объекта.  
Глобальная модель объекта (Deformable Part Models).  
Условно разделим объект интереса на элементарные составные части (в задаче
распознавания велосипеда на изображении такими частями могут быть колёса,
руль, седло и педали велосипеда). Отдельно обучим детектор для каждой из
составных частей. Модель объекта в таком случае будет определять набор
допустимых расположений элементарных частей. При этом модель допускает
изменение взаимных положений частей в некотором диапазоне (деформации).
Допустим, на изображении были распознаны составные части искомого объекта. Сам
объект считается найденным на изображении, если распознанные позиции его
составных частей образуют корректную конфигурацию, удовлетворяющую всем
ограничениям модели (точнее говоря, вычисляются отклики фильтров составных
частей объекта, финальный вес распознавания объекта равна сумме отклики
фильтров составных частей минус штраф за деформацию положений составных
частей, если получившийся вес больше порога, объект считается распознанным на
изображении).  
Выигрыш от использования данного подхода возникает за счёт того, что детекторы
составных частей проще обучить до высокого качества распознавания, поскольку
вариативность внешнего вида составной части гораздо меньше вариативности
внешнего вида всего объекта, следовательно, можно использовать меньший объём
обучающих данных и более простую модель (допустим, объект состоит из 5
последовательных частей, каждая из которых имеет 2 варианта внешнего вида, и
может быть скомбинирована со следующей за ней частью 2-мя способами; в таком
простом примере задачу обучения распознаванию всего объекта можно считать в 28
= 256 раз более сложной по сравнению с обучением распознаванию отдельной
части, в реальных задачах разница будет ещё более существенной).  
Достоинством метода является определённая гарантия корректности результата -
объект заведомо неправильной конфигурации (например, велосипед без колёс)
никогда не будет выдан в качестве успешного распознавания. В литературе данный
класс моделей обычно называют Deformable Part Models. Пример использования
данного подхода можно найти в работе [1] под названием Star model. В данной
работе для распознавания составных частей объектов используется обучение на
базе HOG-дескрипторов.  
Однако, данный подход обладает рядом принципиальных недостатков: Распознавание
объектов с разных ракурсов. При изменении ракурса съёмки внешний вид объекта
интереса может принципиально меняться. Например, изображение велосипеда или
автомобиля сбоку может сильно отличаться от изображения того же велосипеда или
автомобиля спереди, что не позволит использовать для распознавания объекта
единственную модель. Из-за этого приходится строить отдельную модель для
каждого варианта съёмки (пример нескольких моделей для велосипеда представлен
на рисунке 1). При этом сразу же возникает проблема с промежуточными
положениями объекта интереса.  
[Рисунок 1 - Пример Deformable Part Model для распознавания велосипеда [1].] 
Работа в условиях перекрытий. Некоторые из частей объекта интереса могут быть
не видны на изображении из-за перекрытий, хотя по видимым частям объект можно
распознать, используя классические алгоритмы машинного обучения, из-за чего
качество распознавания с использованием модели может получиться хуже качества
распознавания без использования моделей. Для устранения этого недостатка
модель объекта приходится дополнять явным моделированием перекрытий. В
конечном итоге явно моделировать перекрытия выгоднее, чем закладывать
возможность перекрытия в обучающие данные распознающего алгоритма, поскольку в
случае явного моделирования система будет ориентироваться только на
непрерывные перекрытия соседних частей объекта, в то время как для алгоритма
без априорных знаний одинаково возможны как непрерывные перекрытия, так и
несвязные перекрытия отдельных частей объекта, которые невозможны в
действительности. В некоторых работах [2] приводятся примеры использования
такого рода знаний и демонстрируются его преимущества над методами обеспечения
устойчивости к перекрытиям без использования моделирования.  
Моделирование внутриклассового разнообразия. Не всегда объекты точно
соответствуют ограничениям модели. Иногда положение одной из частей объекта
относительно других может непредсказуемо меняться, что будет критично для
методов данной группы, но некритично для методов без жёстких ограничений.
Некоторые классы объектов (например, стулья) имеют слишком большую
вариативность форм, чтобы её можно было описать с помощью подобных моделей.
Для таких случаев требуются более гибкие модели.  
Неустойчивость к пропуску одной из частей объекта распознавателем. Если одна
из частей объекта будет ошибочно не найдена на изображении соответствующим
распознавателем, тогда весь объект не будет распознан (или сильно просядет его
вес, что потребует снизить порог распознавания, что может привести к повышению
числа ложных срабатываний).  
Необходимость ручной разметки обучающих данных. В дополнение к предыдущему
недостатку, чтобы обучить детекторы элементарных частей объекта, придётся
вручную выделять на изображении его составные части, поскольку обычно
подробное описание изображений недоступно.  
Список использованной литературы  
1\. Felzenszwalb P.F. Object Detection with Discriminatively Trained Part
Based Models / P. F. Felzenszwalb, R. B. Girshick, D. McAllester, D. Ramanan.
// IEEE Transactions on Pattern Analysis and Machine Intelligence. -2010 -
Vol. 32(9) - P. 1627-1645.  
2\. Ghiasi G. Occlusion Coherence: Localizing Occluded Faces with a
Hierarchical Deformable Part Model / G. Ghiasi, C. C. Fowlkes // in Computer
Vision and Pattern Recognition (CVPR). - 2014 - P. 1899-1906.  
© Парасич А.В., Парасич И.В., 2016  

